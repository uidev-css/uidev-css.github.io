{"pageProps":{"post":{"title":"í”ŒëŸ¬í„°ì—ì„œ ORMìœ¼ë¡œ Drift ì‚¬ìš©í•˜ê¸°","description":"","date":"2024-06-19 14:28","slug":"2024-06-19-UseDriftforORMinFlutter","content":"\n<img src=\"/assets/img/2024-06-19-UseDriftforORMinFlutter_0.png\" />\n\n# 1. ì†Œê°œ\n\nDriftì€ Dartì™€ Flutter ì• í”Œë¦¬ì¼€ì´ì…˜ìš© ê°•ë ¥í•œ ë°ì´í„°ë² ì´ìŠ¤ ë¼ì´ë¸ŒëŸ¬ë¦¬ì…ë‹ˆë‹¤. íƒ€ì… ì•ˆì •í•œ SQL ì¿¼ë¦¬, ë°ì´í„°ë² ì´ìŠ¤ì˜ ê²€ì¦ ë° ë§ˆì´ê·¸ë ˆì´ì…˜ê³¼ ê°™ì€ ê³ ê¸‰ ê¸°ëŠ¥ì„ ì§€ì›í•˜ê¸° ìœ„í•´, ì»´íŒŒì¼ ì‹œê°„ì— ì‹¤í–‰ë˜ëŠ” ë¹Œë”ì™€ ëª…ë ¹ì¤„ ë„êµ¬ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.\n\nì•„ë˜ í‘œë¥¼ ë§ˆí•‘í•˜ê¸° ìœ„í•œ Dart í´ë˜ìŠ¤ë¥¼ ìƒì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:\n\n<div class=\"content-ad\"></div>\n\n```js\nclass TodoItems extends Table {\n  IntColumn get id => integer().autoIncrement()();\n  TextColumn get title => text().withLength(min: 6, max: 32)();\n  TextColumn get content => text().named('body')();\n  IntColumn get category => integer().nullable()();\n}\n```\n\ní•˜ì§€ë§Œ ì €ëŠ” ORM ì½”ë”©ì„ ìƒì„±í•˜ê¸° ìœ„í•´ SQL ë¬¸ì„ ì‚¬ìš©í•˜ëŠ” ê²ƒì„ ì„ í˜¸í•©ë‹ˆë‹¤ (ë‚˜ì¤‘ì— ë³´ì—¬ë“œë¦¬ê² ìŠµë‹ˆë‹¤). ë³´í†µ í…Œì´ë¸”ìš© SQLì„ ë¨¼ì € ìƒì„±í•˜ê³ , ê·¸ SQLì„ ì¬ì‚¬ìš©í•´ì•¼ í•˜ê¸° ë•Œë¬¸ì— ê´œì°®ì„ ê±°ì˜ˆìš” ğŸ™‚\n\n# 2. ì‚¬ìš©ë²•\n\në‚˜ì¤‘ì— Driftì—ì„œ ëª¨ë¸ì„ ìƒì„±í•  ë•Œ SQL ë¬¸ì„ ì‚¬ìš©í•˜ëŠ” ë°©ë²•ì„ ë³´ì—¬ë“œë¦¬ê² ìŠµë‹ˆë‹¤.\n\n<div class=\"content-ad\"></div>\n\n# 2.1 í•„ìˆ˜ ë¼ì´ë¸ŒëŸ¬ë¦¬ ê°€ì ¸ì˜¤ê¸°\n\nDriftëŠ” sqlite3ì™€ ì½”ë“œë¥¼ ìƒì„±í•˜ëŠ” Flutter ë¹Œë“œ ëŸ¬ë„ˆë¥¼ ê¸°ë°˜ìœ¼ë¡œ í•˜ê³  ìˆê¸° ë•Œë¬¸ì—, pubspec.yaml íŒŒì¼ì— ì•„ë˜ ì¢…ì†ì„±ì„ ê°€ì ¸ì™€ì•¼í•©ë‹ˆë‹¤:\n\n```yaml\ndependencies:\n  drift: ^2.16.0\n  sqlite3_flutter_libs: ^0.5.20\n  path_provider: ^2.1.2\n  path: ^1.9.0\n\ndev_dependencies:\n  drift_dev: ^2.16.0\n  build_runner: ^2.4.8\n```\n\n# 2.2 ë°ì´í„°ë² ì´ìŠ¤ í´ë˜ìŠ¤ ìƒì„±í•˜ê¸°\n\n<div class=\"content-ad\"></div>\n\nì˜ˆë¥¼ ë“¤ì–´, ì±… ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ìƒì„±í•´ì•¼ í•œë‹¤ë©´ ì•„ë˜ì˜ book_database.dart íŒŒì¼ì„ ë§Œë“¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\n```js\nimport 'dart:io';\n\nimport 'package:drift/drift.dart';\nimport 'package:path_provider/path_provider.dart';\nimport 'package:path/path.dart' as p;\nimport 'package:drift/native.dart';\n\npart 'book_database.g.dart'; // ì´ íŒŒì¼ì€ ìƒì„± íŒŒì¼ì´ë©° ê¸°ì¡´ db íŒŒì¼ê³¼ ë™ì¼í•œ íŒŒì¼ ì´ë¦„ì„ ì‚¬ìš©í•´ì•¼ í•¨\n\n@DriftDatabase(\n  include: {'book.drift'}, // ì±… í…Œì´ë¸”ì„ ë§Œë“¤ê¸° ìœ„í•œ SQL íŒŒì¼\n)\nclass BookDatabase extends _$BookDatabase {\n  BookDatabase() : super(_openConnection());\n\n  @override\n  int get schemaVersion => 1;\n}\n\nLazyDatabase _openConnection() {\n  return LazyDatabase(() async {\n    // ë°ì´í„°ë² ì´ìŠ¤ íŒŒì¼ì¸ db.sqliteì„ ì—¬ê¸° ì•±ì˜ documents í´ë”ë¡œ ë„£ìŠµë‹ˆë‹¤.\n    final dbFolder = await getApplicationSupportDirectory();\n\n    // db íŒŒì¼ì˜ ê²½ë¡œ ì„¤ì •\n    final file = File(p.join(dbFolder.path, 'book.db'));\n    return NativeDatabase.createInBackground(file);\n  });\n}\n```\n\n# 2.2 SQL ë¬¸ì¥ íŒŒì¼ ìƒì„±\n\nbook.drift íŒŒì¼ì„ ìƒì„±í•˜ì—¬ í…Œì´ë¸”ì„ ë§Œë“œëŠ” ì¼ë°˜ì ì¸ SQL ë¬¸ì¥ì„ ì…ë ¥í•˜ê³ , SQLì—ì„œ ì‚¬ìš©ì ì •ì˜ ë©”ì„œë“œë„ ìƒì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\n<div class=\"content-ad\"></div>\n\n```js\nCREATE TABLE IF NOT EXISTS \"book\" (\n            \"id\" INTEGER PRIMARY KEY NOT NULL UNIQUE,\n            \"viewCount\" INTEGER DEFAULT(NULL),\n            \"name\" VARCHAR(64) COLLATE NOCASE NOT NULL UNIQUE,\n            \"artist\" VARCHAR(64) COLLATE NOCASE NOT NULL,\n            \"folder\" VARCHAR(64) COLLATE NOCASE NOT NULL,\n            \"coverImg\" VARCHAR(64) COLLATE NOCASE NOT NULL\n);\nCREATE UNIQUE INDEX IF NOT EXISTS \"book_1\" ON book (id);\nCREATE UNIQUE INDEX IF NOT EXISTS \"book_2\" ON book (name);\n\nisBookExists: Select count(*) from book where name = :name Limit 1;\nfilterBooks: SELECT * FROM book WHERE $predicate;\ngetTop10: SELECT * FROM book ORDER BY viewCount DESC Limit 10;\n```\n\nì—¬ê¸°ì„œ ê°„ë‹¨í•œ book í…Œì´ë¸”ì„ ë§Œë“¤ì—ˆê³ , id ë° name ì—´ì— ëŒ€í•œ ì¸ë±ìŠ¤ë¥¼ ìƒì„±í–ˆìŠµë‹ˆë‹¤. í•œí¸, 3ê°€ì§€ ì‚¬ìš©ì ì •ì˜ ë©”ì„œë“œë„ ë§Œë“¤ì—ˆê³ , ì´í›„ì— ì‚¬ìš© ë°©ë²•ì„ ì•Œë ¤ë“œë¦¬ê² ìŠµë‹ˆë‹¤.\n\nì½”ë“œë¥¼ ìƒì„±í•œ í›„ driftê°€ dart ì½”ë“œë¡œ DB ë„ìš°ë¯¸ í´ë˜ìŠ¤ì—ì„œ ì´ëŸ¬í•œ 3ê°€ì§€ ë©”ì„œë“œë¥¼ ìë™ìœ¼ë¡œ ìƒì„±í•  ê²ƒì…ë‹ˆë‹¤.\n\n# 2.3 ë°ì´í„°ë² ì´ìŠ¤ ë„ìš°ë¯¸ í´ë˜ìŠ¤ ìƒì„±í•˜ê¸°\n\n<div class=\"content-ad\"></div>\n\nì•„ë˜ ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•˜ì—¬ DB í—¬í¼ í´ë˜ìŠ¤ë¥¼ ìƒì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:\n\n```js\ndart run build_runner build\n```\n\nê·¸ ê²°ê³¼ë¡œ book_database.g.dartì™€ ê°™ì€ í•˜ë‚˜ì˜ íŒŒì¼ì´ ë” ìƒì„±ë  ê²ƒì´ê³ , í•´ë‹¹ íŒŒì¼ ì•ˆì— ì‚¬ìš©ì ì •ì˜ ë©”ì„œë“œë„ ì°¾ì„ ìˆ˜ ìˆì„ ê±°ì˜ˆìš”. ë¬¼ë¡ , ì´ ë™ì‘ ë°©ì‹ì— ëŒ€í•´ ê±±ì •í•  í•„ìš”ëŠ” ì—†ìŠµë‹ˆë‹¤. ê·¸ëƒ¥ ì‚¬ìš©í•˜ë©´ ë©ë‹ˆë‹¤!\n\n# 2.4 ë°ì´í„°ë² ì´ìŠ¤ í—¬í¼ ì‚¬ìš©í•˜ê¸°\n\n<div class=\"content-ad\"></div>\n\nìš°ë¦¬ëŠ” ì˜ˆì‹œë¡œ GetX í”„ë ˆì„ì›Œí¬ë¥¼ ì‚¬ìš©í•  ê²ƒì…ë‹ˆë‹¤.\n\nmain.dart íŒŒì¼ì— BookDatabase í´ë˜ìŠ¤ë¥¼ ë„£ì–´ì£¼ì„¸ìš”.\n\n```js\nGet.put(BookDatabase());\n```\n\nì´ì œ ìš°ë¦¬ëŠ” ì–´ë””ì„œë“  ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:\n\n<div class=\"content-ad\"></div>\n\n```js\n//ì±… DB ë„ìš°ë¯¸ ê°€ì ¸ì˜¤ê¸°\nfinal BookDatabase _bookDB = Get.find<BookDatabase>();\n\n...\n\n//DBì—ì„œ ëª¨ë“  ì±… ì•„ì´í…œ ê°€ì ¸ì˜¤ê¸°\nvar dbBooks = await _bookDB.book.select().get();\n...\n//ì±… ì•„ì´í…œì˜ folder ì—´ë§Œ ì—…ë°ì´íŠ¸í•˜ì—¬ DBì— ì €ì¥\n_bookDB.updateBookItem(\n  bookItem.id,\n  BookCompanion(\n      folder: drift.Value(bookItem.folder),\n  ),\n);\n...\n//ì±… ì•„ì´í…œ ì¼ê´„ ì‚½ì…\nList<BookData> dbBooks = [];\ndbBooks.add(BookData(\n        id: 1,\n        viewCount: 0,\n        name: 'book 1',\n        artist: 'artist 1',\n        folder: 'assets/books/01/',\n        coverImg: 'assets/books/01/cover.jpg',));\ndbBooks.add(BookData(\n        id: 2,\n        viewCount: 0,\n        name: 'book 2',\n        artist: 'artist 2',\n        folder: 'assets/books/02/',\n        coverImg: 'assets/books/02/cover.jpg',));\n_bookDB.book.insertAll(dbBooks);e custom methods\n```\n\nì˜ˆì œì—ì„œëŠ” SQL ë¬¸ìœ¼ë¡œ 3ê°œì˜ ë©”ì„œë“œë¥¼ ì •ì˜í–ˆìŠµë‹ˆë‹¤:\n\n```js\nisBookExists: Select count(*) from book where name = :name Limit 1 ;\nfilterBooks: SELECT * FROM book WHERE $predicate;\ngetTop10: SELECT * FROM book ORDER BY viewCount DESC Limit 10;\n```\n\nì•„ë˜ì—ì„œ ì´ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\n<div class=\"content-ad\"></div>\n\n```js\n// ë„ì„œ ì´ë¦„ìœ¼ë¡œ ì±…ì´ ìˆëŠ”ì§€ í™•ì¸\nint bookCount = await _bookDB.isBookExists('bookName').getSingle();\n\n// ì‚¬ìš©ì ì§€ì • í•„í„°ë¡œ ì±… ê°€ì ¸ì˜¤ê¸°\nvar bookItems = await _bookDB.filterBooks((book) => book.name.contains('bookName')).get();\n\n// ìƒìœ„ 10ê¶Œì˜ ì±… ê°€ì ¸ì˜¤ê¸°\nvar topTenBooks = await _bookDB.getTop10().get();\n```\n\n# 3. ê²°ë¡ \n\nDriftëŠ” ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ê´€ë¦¬í•˜ëŠ” ë° ìœ ìš©í•©ë‹ˆë‹¤. ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ê¸° ìœ„í•´ ì‚¬ìš©ì ì§€ì • ë©”ì„œë“œë¥¼ ìƒì„±í•  ìˆ˜ ìˆìœ¼ë©° SQL ë¬¸ì„ ì‚¬ìš©í•˜ì§€ ì•Šê³  Dart APIë¥¼ ì‚¬ìš©í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤. ìì„¸í•œ ë‚´ìš©ì€ ì—¬ê¸°ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì—¬ì „íˆ ì˜¤í”¼ì„œ ì›¹ì‚¬ì´íŠ¸ì—ì„œ ë§ì€ ê°•ë ¥í•œ ê¸°ëŠ¥ì„ ì°¾ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\nì´ ê¸€ì´ ë§ˆìŒì— ë“œì…¨ë‹¤ë©´ .Net Core, Angular ë° ê¸°íƒ€ ê¸°ìˆ ì— ê´€í•œ ë” ë§ì€ ì´ì•¼ê¸°ë¥¼ ë³´ë ¤ë©´ Mediumì—ì„œ íŒ”ë¡œìš°í•´ì£¼ì„¸ìš”! ğŸ™‚\n","ogImage":{"url":"/assets/img/2024-06-19-UseDriftforORMinFlutter_0.png"},"coverImage":"/assets/img/2024-06-19-UseDriftforORMinFlutter_0.png","tag":["Tech"],"readingTime":6},"content":"<!doctype html>\n<html lang=\"en\">\n<head>\n<meta charset=\"utf-8\">\n<meta content=\"width=device-width, initial-scale=1\" name=\"viewport\">\n</head>\n<body>\n<img src=\"/assets/img/2024-06-19-UseDriftforORMinFlutter_0.png\">\n<h1>1. ì†Œê°œ</h1>\n<p>Driftì€ Dartì™€ Flutter ì• í”Œë¦¬ì¼€ì´ì…˜ìš© ê°•ë ¥í•œ ë°ì´í„°ë² ì´ìŠ¤ ë¼ì´ë¸ŒëŸ¬ë¦¬ì…ë‹ˆë‹¤. íƒ€ì… ì•ˆì •í•œ SQL ì¿¼ë¦¬, ë°ì´í„°ë² ì´ìŠ¤ì˜ ê²€ì¦ ë° ë§ˆì´ê·¸ë ˆì´ì…˜ê³¼ ê°™ì€ ê³ ê¸‰ ê¸°ëŠ¥ì„ ì§€ì›í•˜ê¸° ìœ„í•´, ì»´íŒŒì¼ ì‹œê°„ì— ì‹¤í–‰ë˜ëŠ” ë¹Œë”ì™€ ëª…ë ¹ì¤„ ë„êµ¬ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.</p>\n<p>ì•„ë˜ í‘œë¥¼ ë§ˆí•‘í•˜ê¸° ìœ„í•œ Dart í´ë˜ìŠ¤ë¥¼ ìƒì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:</p>\n<div class=\"content-ad\"></div>\n<pre><code class=\"hljs language-js\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">TodoItems</span> <span class=\"hljs-keyword\">extends</span> <span class=\"hljs-title class_ inherited__\">Table</span> {\n  <span class=\"hljs-title class_\">IntColumn</span> get id => <span class=\"hljs-title function_\">integer</span>().<span class=\"hljs-title function_\">autoIncrement</span>()();\n  <span class=\"hljs-title class_\">TextColumn</span> get title => <span class=\"hljs-title function_\">text</span>().<span class=\"hljs-title function_\">withLength</span>(<span class=\"hljs-attr\">min</span>: <span class=\"hljs-number\">6</span>, <span class=\"hljs-attr\">max</span>: <span class=\"hljs-number\">32</span>)();\n  <span class=\"hljs-title class_\">TextColumn</span> get content => <span class=\"hljs-title function_\">text</span>().<span class=\"hljs-title function_\">named</span>(<span class=\"hljs-string\">'body'</span>)();\n  <span class=\"hljs-title class_\">IntColumn</span> get category => <span class=\"hljs-title function_\">integer</span>().<span class=\"hljs-title function_\">nullable</span>()();\n}\n</code></pre>\n<p>í•˜ì§€ë§Œ ì €ëŠ” ORM ì½”ë”©ì„ ìƒì„±í•˜ê¸° ìœ„í•´ SQL ë¬¸ì„ ì‚¬ìš©í•˜ëŠ” ê²ƒì„ ì„ í˜¸í•©ë‹ˆë‹¤ (ë‚˜ì¤‘ì— ë³´ì—¬ë“œë¦¬ê² ìŠµë‹ˆë‹¤). ë³´í†µ í…Œì´ë¸”ìš© SQLì„ ë¨¼ì € ìƒì„±í•˜ê³ , ê·¸ SQLì„ ì¬ì‚¬ìš©í•´ì•¼ í•˜ê¸° ë•Œë¬¸ì— ê´œì°®ì„ ê±°ì˜ˆìš” ğŸ™‚</p>\n<h1>2. ì‚¬ìš©ë²•</h1>\n<p>ë‚˜ì¤‘ì— Driftì—ì„œ ëª¨ë¸ì„ ìƒì„±í•  ë•Œ SQL ë¬¸ì„ ì‚¬ìš©í•˜ëŠ” ë°©ë²•ì„ ë³´ì—¬ë“œë¦¬ê² ìŠµë‹ˆë‹¤.</p>\n<div class=\"content-ad\"></div>\n<h1>2.1 í•„ìˆ˜ ë¼ì´ë¸ŒëŸ¬ë¦¬ ê°€ì ¸ì˜¤ê¸°</h1>\n<p>DriftëŠ” sqlite3ì™€ ì½”ë“œë¥¼ ìƒì„±í•˜ëŠ” Flutter ë¹Œë“œ ëŸ¬ë„ˆë¥¼ ê¸°ë°˜ìœ¼ë¡œ í•˜ê³  ìˆê¸° ë•Œë¬¸ì—, pubspec.yaml íŒŒì¼ì— ì•„ë˜ ì¢…ì†ì„±ì„ ê°€ì ¸ì™€ì•¼í•©ë‹ˆë‹¤:</p>\n<pre><code class=\"hljs language-yaml\"><span class=\"hljs-attr\">dependencies:</span>\n  <span class=\"hljs-attr\">drift:</span> <span class=\"hljs-string\">^2.16.0</span>\n  <span class=\"hljs-attr\">sqlite3_flutter_libs:</span> <span class=\"hljs-string\">^0.5.20</span>\n  <span class=\"hljs-attr\">path_provider:</span> <span class=\"hljs-string\">^2.1.2</span>\n  <span class=\"hljs-attr\">path:</span> <span class=\"hljs-string\">^1.9.0</span>\n\n<span class=\"hljs-attr\">dev_dependencies:</span>\n  <span class=\"hljs-attr\">drift_dev:</span> <span class=\"hljs-string\">^2.16.0</span>\n  <span class=\"hljs-attr\">build_runner:</span> <span class=\"hljs-string\">^2.4.8</span>\n</code></pre>\n<h1>2.2 ë°ì´í„°ë² ì´ìŠ¤ í´ë˜ìŠ¤ ìƒì„±í•˜ê¸°</h1>\n<div class=\"content-ad\"></div>\n<p>ì˜ˆë¥¼ ë“¤ì–´, ì±… ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ìƒì„±í•´ì•¼ í•œë‹¤ë©´ ì•„ë˜ì˜ book_database.dart íŒŒì¼ì„ ë§Œë“¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>\n<pre><code class=\"hljs language-js\"><span class=\"hljs-keyword\">import</span> <span class=\"hljs-string\">'dart:io'</span>;\n\n<span class=\"hljs-keyword\">import</span> <span class=\"hljs-string\">'package:drift/drift.dart'</span>;\n<span class=\"hljs-keyword\">import</span> <span class=\"hljs-string\">'package:path_provider/path_provider.dart'</span>;\n<span class=\"hljs-keyword\">import</span> <span class=\"hljs-string\">'package:path/path.dart'</span> <span class=\"hljs-keyword\">as</span> p;\n<span class=\"hljs-keyword\">import</span> <span class=\"hljs-string\">'package:drift/native.dart'</span>;\n\npart <span class=\"hljs-string\">'book_database.g.dart'</span>; <span class=\"hljs-comment\">// ì´ íŒŒì¼ì€ ìƒì„± íŒŒì¼ì´ë©° ê¸°ì¡´ db íŒŒì¼ê³¼ ë™ì¼í•œ íŒŒì¼ ì´ë¦„ì„ ì‚¬ìš©í•´ì•¼ í•¨</span>\n\n@<span class=\"hljs-title class_\">DriftDatabase</span>(\n  <span class=\"hljs-attr\">include</span>: {<span class=\"hljs-string\">'book.drift'</span>}, <span class=\"hljs-comment\">// ì±… í…Œì´ë¸”ì„ ë§Œë“¤ê¸° ìœ„í•œ SQL íŒŒì¼</span>\n)\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">BookDatabase</span> <span class=\"hljs-keyword\">extends</span> <span class=\"hljs-title class_ inherited__\">_$BookDatabase</span> {\n  <span class=\"hljs-title class_\">BookDatabase</span>() : <span class=\"hljs-variable language_\">super</span>(<span class=\"hljs-title function_\">_openConnection</span>());\n\n  @override\n  int get schemaVersion => <span class=\"hljs-number\">1</span>;\n}\n\n<span class=\"hljs-title class_\">LazyDatabase</span> <span class=\"hljs-title function_\">_openConnection</span>(<span class=\"hljs-params\"></span>) {\n  <span class=\"hljs-keyword\">return</span> <span class=\"hljs-title class_\">LazyDatabase</span>(() <span class=\"hljs-keyword\">async</span> {\n    <span class=\"hljs-comment\">// ë°ì´í„°ë² ì´ìŠ¤ íŒŒì¼ì¸ db.sqliteì„ ì—¬ê¸° ì•±ì˜ documents í´ë”ë¡œ ë„£ìŠµë‹ˆë‹¤.</span>\n    final dbFolder = <span class=\"hljs-keyword\">await</span> <span class=\"hljs-title function_\">getApplicationSupportDirectory</span>();\n\n    <span class=\"hljs-comment\">// db íŒŒì¼ì˜ ê²½ë¡œ ì„¤ì •</span>\n    final file = <span class=\"hljs-title class_\">File</span>(p.<span class=\"hljs-title function_\">join</span>(dbFolder.<span class=\"hljs-property\">path</span>, <span class=\"hljs-string\">'book.db'</span>));\n    <span class=\"hljs-keyword\">return</span> <span class=\"hljs-title class_\">NativeDatabase</span>.<span class=\"hljs-title function_\">createInBackground</span>(file);\n  });\n}\n</code></pre>\n<h1>2.2 SQL ë¬¸ì¥ íŒŒì¼ ìƒì„±</h1>\n<p>book.drift íŒŒì¼ì„ ìƒì„±í•˜ì—¬ í…Œì´ë¸”ì„ ë§Œë“œëŠ” ì¼ë°˜ì ì¸ SQL ë¬¸ì¥ì„ ì…ë ¥í•˜ê³ , SQLì—ì„œ ì‚¬ìš©ì ì •ì˜ ë©”ì„œë“œë„ ìƒì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>\n<div class=\"content-ad\"></div>\n<pre><code class=\"hljs language-js\"><span class=\"hljs-variable constant_\">CREATE</span> <span class=\"hljs-variable constant_\">TABLE</span> <span class=\"hljs-variable constant_\">IF</span> <span class=\"hljs-variable constant_\">NOT</span> <span class=\"hljs-variable constant_\">EXISTS</span> <span class=\"hljs-string\">\"book\"</span> (\n            <span class=\"hljs-string\">\"id\"</span> <span class=\"hljs-variable constant_\">INTEGER</span> <span class=\"hljs-variable constant_\">PRIMARY</span> <span class=\"hljs-variable constant_\">KEY</span> <span class=\"hljs-variable constant_\">NOT</span> <span class=\"hljs-variable constant_\">NULL</span> <span class=\"hljs-variable constant_\">UNIQUE</span>,\n            <span class=\"hljs-string\">\"viewCount\"</span> <span class=\"hljs-variable constant_\">INTEGER</span> <span class=\"hljs-title function_\">DEFAULT</span>(<span class=\"hljs-variable constant_\">NULL</span>),\n            <span class=\"hljs-string\">\"name\"</span> <span class=\"hljs-title function_\">VARCHAR</span>(<span class=\"hljs-number\">64</span>) <span class=\"hljs-variable constant_\">COLLATE</span> <span class=\"hljs-variable constant_\">NOCASE</span> <span class=\"hljs-variable constant_\">NOT</span> <span class=\"hljs-variable constant_\">NULL</span> <span class=\"hljs-variable constant_\">UNIQUE</span>,\n            <span class=\"hljs-string\">\"artist\"</span> <span class=\"hljs-title function_\">VARCHAR</span>(<span class=\"hljs-number\">64</span>) <span class=\"hljs-variable constant_\">COLLATE</span> <span class=\"hljs-variable constant_\">NOCASE</span> <span class=\"hljs-variable constant_\">NOT</span> <span class=\"hljs-variable constant_\">NULL</span>,\n            <span class=\"hljs-string\">\"folder\"</span> <span class=\"hljs-title function_\">VARCHAR</span>(<span class=\"hljs-number\">64</span>) <span class=\"hljs-variable constant_\">COLLATE</span> <span class=\"hljs-variable constant_\">NOCASE</span> <span class=\"hljs-variable constant_\">NOT</span> <span class=\"hljs-variable constant_\">NULL</span>,\n            <span class=\"hljs-string\">\"coverImg\"</span> <span class=\"hljs-title function_\">VARCHAR</span>(<span class=\"hljs-number\">64</span>) <span class=\"hljs-variable constant_\">COLLATE</span> <span class=\"hljs-variable constant_\">NOCASE</span> <span class=\"hljs-variable constant_\">NOT</span> <span class=\"hljs-variable constant_\">NULL</span>\n);\n<span class=\"hljs-variable constant_\">CREATE</span> <span class=\"hljs-variable constant_\">UNIQUE</span> <span class=\"hljs-variable constant_\">INDEX</span> <span class=\"hljs-variable constant_\">IF</span> <span class=\"hljs-variable constant_\">NOT</span> <span class=\"hljs-variable constant_\">EXISTS</span> <span class=\"hljs-string\">\"book_1\"</span> <span class=\"hljs-variable constant_\">ON</span> book (id);\n<span class=\"hljs-variable constant_\">CREATE</span> <span class=\"hljs-variable constant_\">UNIQUE</span> <span class=\"hljs-variable constant_\">INDEX</span> <span class=\"hljs-variable constant_\">IF</span> <span class=\"hljs-variable constant_\">NOT</span> <span class=\"hljs-variable constant_\">EXISTS</span> <span class=\"hljs-string\">\"book_2\"</span> <span class=\"hljs-variable constant_\">ON</span> book (name);\n\n<span class=\"hljs-attr\">isBookExists</span>: <span class=\"hljs-title class_\">Select</span> <span class=\"hljs-title function_\">count</span>(*) <span class=\"hljs-keyword\">from</span> book where name = :name <span class=\"hljs-title class_\">Limit</span> <span class=\"hljs-number\">1</span>;\n<span class=\"hljs-attr\">filterBooks</span>: <span class=\"hljs-variable constant_\">SELECT</span> * <span class=\"hljs-variable constant_\">FROM</span> book <span class=\"hljs-variable constant_\">WHERE</span> $predicate;\n<span class=\"hljs-attr\">getTop10</span>: <span class=\"hljs-variable constant_\">SELECT</span> * <span class=\"hljs-variable constant_\">FROM</span> book <span class=\"hljs-variable constant_\">ORDER</span> <span class=\"hljs-variable constant_\">BY</span> viewCount <span class=\"hljs-variable constant_\">DESC</span> <span class=\"hljs-title class_\">Limit</span> <span class=\"hljs-number\">10</span>;\n</code></pre>\n<p>ì—¬ê¸°ì„œ ê°„ë‹¨í•œ book í…Œì´ë¸”ì„ ë§Œë“¤ì—ˆê³ , id ë° name ì—´ì— ëŒ€í•œ ì¸ë±ìŠ¤ë¥¼ ìƒì„±í–ˆìŠµë‹ˆë‹¤. í•œí¸, 3ê°€ì§€ ì‚¬ìš©ì ì •ì˜ ë©”ì„œë“œë„ ë§Œë“¤ì—ˆê³ , ì´í›„ì— ì‚¬ìš© ë°©ë²•ì„ ì•Œë ¤ë“œë¦¬ê² ìŠµë‹ˆë‹¤.</p>\n<p>ì½”ë“œë¥¼ ìƒì„±í•œ í›„ driftê°€ dart ì½”ë“œë¡œ DB ë„ìš°ë¯¸ í´ë˜ìŠ¤ì—ì„œ ì´ëŸ¬í•œ 3ê°€ì§€ ë©”ì„œë“œë¥¼ ìë™ìœ¼ë¡œ ìƒì„±í•  ê²ƒì…ë‹ˆë‹¤.</p>\n<h1>2.3 ë°ì´í„°ë² ì´ìŠ¤ ë„ìš°ë¯¸ í´ë˜ìŠ¤ ìƒì„±í•˜ê¸°</h1>\n<div class=\"content-ad\"></div>\n<p>ì•„ë˜ ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•˜ì—¬ DB í—¬í¼ í´ë˜ìŠ¤ë¥¼ ìƒì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:</p>\n<pre><code class=\"hljs language-js\">dart run build_runner build\n</code></pre>\n<p>ê·¸ ê²°ê³¼ë¡œ book_database.g.dartì™€ ê°™ì€ í•˜ë‚˜ì˜ íŒŒì¼ì´ ë” ìƒì„±ë  ê²ƒì´ê³ , í•´ë‹¹ íŒŒì¼ ì•ˆì— ì‚¬ìš©ì ì •ì˜ ë©”ì„œë“œë„ ì°¾ì„ ìˆ˜ ìˆì„ ê±°ì˜ˆìš”. ë¬¼ë¡ , ì´ ë™ì‘ ë°©ì‹ì— ëŒ€í•´ ê±±ì •í•  í•„ìš”ëŠ” ì—†ìŠµë‹ˆë‹¤. ê·¸ëƒ¥ ì‚¬ìš©í•˜ë©´ ë©ë‹ˆë‹¤!</p>\n<h1>2.4 ë°ì´í„°ë² ì´ìŠ¤ í—¬í¼ ì‚¬ìš©í•˜ê¸°</h1>\n<div class=\"content-ad\"></div>\n<p>ìš°ë¦¬ëŠ” ì˜ˆì‹œë¡œ GetX í”„ë ˆì„ì›Œí¬ë¥¼ ì‚¬ìš©í•  ê²ƒì…ë‹ˆë‹¤.</p>\n<p>main.dart íŒŒì¼ì— BookDatabase í´ë˜ìŠ¤ë¥¼ ë„£ì–´ì£¼ì„¸ìš”.</p>\n<pre><code class=\"hljs language-js\"><span class=\"hljs-title class_\">Get</span>.<span class=\"hljs-title function_\">put</span>(<span class=\"hljs-title class_\">BookDatabase</span>());\n</code></pre>\n<p>ì´ì œ ìš°ë¦¬ëŠ” ì–´ë””ì„œë“  ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:</p>\n<div class=\"content-ad\"></div>\n<pre><code class=\"hljs language-js\"><span class=\"hljs-comment\">//ì±… DB ë„ìš°ë¯¸ ê°€ì ¸ì˜¤ê¸°</span>\nfinal <span class=\"hljs-title class_\">BookDatabase</span> _bookDB = <span class=\"hljs-title class_\">Get</span>.<span class=\"hljs-property\">find</span>&#x3C;<span class=\"hljs-title class_\">BookDatabase</span>>();\n\n...\n\n<span class=\"hljs-comment\">//DBì—ì„œ ëª¨ë“  ì±… ì•„ì´í…œ ê°€ì ¸ì˜¤ê¸°</span>\n<span class=\"hljs-keyword\">var</span> dbBooks = <span class=\"hljs-keyword\">await</span> _bookDB.<span class=\"hljs-property\">book</span>.<span class=\"hljs-title function_\">select</span>().<span class=\"hljs-title function_\">get</span>();\n...\n<span class=\"hljs-comment\">//ì±… ì•„ì´í…œì˜ folder ì—´ë§Œ ì—…ë°ì´íŠ¸í•˜ì—¬ DBì— ì €ì¥</span>\n_bookDB.<span class=\"hljs-title function_\">updateBookItem</span>(\n  bookItem.<span class=\"hljs-property\">id</span>,\n  <span class=\"hljs-title class_\">BookCompanion</span>(\n      <span class=\"hljs-attr\">folder</span>: drift.<span class=\"hljs-title class_\">Value</span>(bookItem.<span class=\"hljs-property\">folder</span>),\n  ),\n);\n...\n<span class=\"hljs-comment\">//ì±… ì•„ì´í…œ ì¼ê´„ ì‚½ì…</span>\n<span class=\"hljs-title class_\">List</span>&#x3C;<span class=\"hljs-title class_\">BookData</span>> dbBooks = [];\ndbBooks.<span class=\"hljs-title function_\">add</span>(<span class=\"hljs-title class_\">BookData</span>(\n        <span class=\"hljs-attr\">id</span>: <span class=\"hljs-number\">1</span>,\n        <span class=\"hljs-attr\">viewCount</span>: <span class=\"hljs-number\">0</span>,\n        <span class=\"hljs-attr\">name</span>: <span class=\"hljs-string\">'book 1'</span>,\n        <span class=\"hljs-attr\">artist</span>: <span class=\"hljs-string\">'artist 1'</span>,\n        <span class=\"hljs-attr\">folder</span>: <span class=\"hljs-string\">'assets/books/01/'</span>,\n        <span class=\"hljs-attr\">coverImg</span>: <span class=\"hljs-string\">'assets/books/01/cover.jpg'</span>,));\ndbBooks.<span class=\"hljs-title function_\">add</span>(<span class=\"hljs-title class_\">BookData</span>(\n        <span class=\"hljs-attr\">id</span>: <span class=\"hljs-number\">2</span>,\n        <span class=\"hljs-attr\">viewCount</span>: <span class=\"hljs-number\">0</span>,\n        <span class=\"hljs-attr\">name</span>: <span class=\"hljs-string\">'book 2'</span>,\n        <span class=\"hljs-attr\">artist</span>: <span class=\"hljs-string\">'artist 2'</span>,\n        <span class=\"hljs-attr\">folder</span>: <span class=\"hljs-string\">'assets/books/02/'</span>,\n        <span class=\"hljs-attr\">coverImg</span>: <span class=\"hljs-string\">'assets/books/02/cover.jpg'</span>,));\n_bookDB.<span class=\"hljs-property\">book</span>.<span class=\"hljs-title function_\">insertAll</span>(dbBooks);e custom methods\n</code></pre>\n<p>ì˜ˆì œì—ì„œëŠ” SQL ë¬¸ìœ¼ë¡œ 3ê°œì˜ ë©”ì„œë“œë¥¼ ì •ì˜í–ˆìŠµë‹ˆë‹¤:</p>\n<pre><code class=\"hljs language-js\"><span class=\"hljs-attr\">isBookExists</span>: <span class=\"hljs-title class_\">Select</span> <span class=\"hljs-title function_\">count</span>(*) <span class=\"hljs-keyword\">from</span> book where name = :name <span class=\"hljs-title class_\">Limit</span> <span class=\"hljs-number\">1</span> ;\n<span class=\"hljs-attr\">filterBooks</span>: <span class=\"hljs-variable constant_\">SELECT</span> * <span class=\"hljs-variable constant_\">FROM</span> book <span class=\"hljs-variable constant_\">WHERE</span> $predicate;\n<span class=\"hljs-attr\">getTop10</span>: <span class=\"hljs-variable constant_\">SELECT</span> * <span class=\"hljs-variable constant_\">FROM</span> book <span class=\"hljs-variable constant_\">ORDER</span> <span class=\"hljs-variable constant_\">BY</span> viewCount <span class=\"hljs-variable constant_\">DESC</span> <span class=\"hljs-title class_\">Limit</span> <span class=\"hljs-number\">10</span>;\n</code></pre>\n<p>ì•„ë˜ì—ì„œ ì´ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>\n<div class=\"content-ad\"></div>\n<pre><code class=\"hljs language-js\"><span class=\"hljs-comment\">// ë„ì„œ ì´ë¦„ìœ¼ë¡œ ì±…ì´ ìˆëŠ”ì§€ í™•ì¸</span>\nint bookCount = <span class=\"hljs-keyword\">await</span> _bookDB.<span class=\"hljs-title function_\">isBookExists</span>(<span class=\"hljs-string\">'bookName'</span>).<span class=\"hljs-title function_\">getSingle</span>();\n\n<span class=\"hljs-comment\">// ì‚¬ìš©ì ì§€ì • í•„í„°ë¡œ ì±… ê°€ì ¸ì˜¤ê¸°</span>\n<span class=\"hljs-keyword\">var</span> bookItems = <span class=\"hljs-keyword\">await</span> _bookDB.<span class=\"hljs-title function_\">filterBooks</span>(<span class=\"hljs-function\">(<span class=\"hljs-params\">book</span>) =></span> book.<span class=\"hljs-property\">name</span>.<span class=\"hljs-title function_\">contains</span>(<span class=\"hljs-string\">'bookName'</span>)).<span class=\"hljs-title function_\">get</span>();\n\n<span class=\"hljs-comment\">// ìƒìœ„ 10ê¶Œì˜ ì±… ê°€ì ¸ì˜¤ê¸°</span>\n<span class=\"hljs-keyword\">var</span> topTenBooks = <span class=\"hljs-keyword\">await</span> _bookDB.<span class=\"hljs-title function_\">getTop10</span>().<span class=\"hljs-title function_\">get</span>();\n</code></pre>\n<h1>3. ê²°ë¡ </h1>\n<p>DriftëŠ” ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ê´€ë¦¬í•˜ëŠ” ë° ìœ ìš©í•©ë‹ˆë‹¤. ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ê¸° ìœ„í•´ ì‚¬ìš©ì ì§€ì • ë©”ì„œë“œë¥¼ ìƒì„±í•  ìˆ˜ ìˆìœ¼ë©° SQL ë¬¸ì„ ì‚¬ìš©í•˜ì§€ ì•Šê³  Dart APIë¥¼ ì‚¬ìš©í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤. ìì„¸í•œ ë‚´ìš©ì€ ì—¬ê¸°ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì—¬ì „íˆ ì˜¤í”¼ì„œ ì›¹ì‚¬ì´íŠ¸ì—ì„œ ë§ì€ ê°•ë ¥í•œ ê¸°ëŠ¥ì„ ì°¾ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>\n<p>ì´ ê¸€ì´ ë§ˆìŒì— ë“œì…¨ë‹¤ë©´ .Net Core, Angular ë° ê¸°íƒ€ ê¸°ìˆ ì— ê´€í•œ ë” ë§ì€ ì´ì•¼ê¸°ë¥¼ ë³´ë ¤ë©´ Mediumì—ì„œ íŒ”ë¡œìš°í•´ì£¼ì„¸ìš”! ğŸ™‚</p>\n</body>\n</html>\n"},"__N_SSG":true}