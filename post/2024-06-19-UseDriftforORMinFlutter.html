<!DOCTYPE html><html lang="ko"><head><meta charSet="utf-8"/><title>플러터에서 ORM으로 Drift 사용하기 | uidev-css</title><meta name="description" content=""/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta property="og:url" content="https://uidev-css.github.io///post/2024-06-19-UseDriftforORMinFlutter" data-gatsby-head="true"/><meta property="og:type" content="website" data-gatsby-head="true"/><meta property="og:site_name" content="플러터에서 ORM으로 Drift 사용하기 | uidev-css" data-gatsby-head="true"/><meta property="og:title" content="플러터에서 ORM으로 Drift 사용하기 | uidev-css" data-gatsby-head="true"/><meta property="og:description" content="" data-gatsby-head="true"/><meta property="og:image" content="/assets/img/2024-06-19-UseDriftforORMinFlutter_0.png" data-gatsby-head="true"/><meta property="og:locale" content="en_US" data-gatsby-head="true"/><meta name="twitter:card" content="summary_large_image" data-gatsby-head="true"/><meta property="twitter:domain" content="https://uidev-css.github.io/" data-gatsby-head="true"/><meta property="twitter:url" content="https://uidev-css.github.io///post/2024-06-19-UseDriftforORMinFlutter" data-gatsby-head="true"/><meta name="twitter:title" content="플러터에서 ORM으로 Drift 사용하기 | uidev-css" data-gatsby-head="true"/><meta name="twitter:description" content="" data-gatsby-head="true"/><meta name="twitter:image" content="/assets/img/2024-06-19-UseDriftforORMinFlutter_0.png" data-gatsby-head="true"/><meta name="twitter:data1" content="Dev | uidev-css" data-gatsby-head="true"/><meta name="article:published_time" content="2024-06-19 14:28" data-gatsby-head="true"/><meta name="next-head-count" content="19"/><meta name="google-site-verification" content="a-yehRo3k3xv7fg6LqRaE8jlE42e5wP2bDE_2F849O4"/><link rel="stylesheet" href="/favicons/favicon.ico"/><link rel="icon" type="image/png" sizes="16x16" href="/assets/favicons/favicon-16x16.png"/><link rel="icon" type="image/png" sizes="32x32" href="/assets/favicons/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="96x96" href="/assets/favicons/favicon-96x96.png"/><link rel="icon" href="/favicons/apple-icon-180x180.png"/><link rel="apple-touch-icon" href="/favicons/apple-icon-180x180.png"/><link rel="apple-touch-startup-image" href="/startup.png"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="black"/><meta name="msapplication-config" content="/favicons/browserconfig.xml"/><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-BHFR6GTH9P"></script><script>window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
          
            gtag('config', 'G-BHFR6GTH9P');</script><link rel="preload" href="/_next/static/css/6e57edcf9f2ce551.css" as="style"/><link rel="stylesheet" href="/_next/static/css/6e57edcf9f2ce551.css" data-n-g=""/><link rel="preload" href="/_next/static/css/b8ef307c9aee1e34.css" as="style"/><link rel="stylesheet" href="/_next/static/css/b8ef307c9aee1e34.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-ee6df16fdc6dae4d.js" defer=""></script><script src="/_next/static/chunks/framework-46611630e39cfdeb.js" defer=""></script><script src="/_next/static/chunks/main-cf4a52eec9a970a0.js" defer=""></script><script src="/_next/static/chunks/pages/_app-6fae11262ee5c69b.js" defer=""></script><script src="/_next/static/chunks/75fc9c18-4a646156c659a948.js" defer=""></script><script src="/_next/static/chunks/348-d11c34b645b13f5b.js" defer=""></script><script src="/_next/static/chunks/162-4172e84c8e2aa747.js" defer=""></script><script src="/_next/static/chunks/pages/post/%5Bslug%5D-b75a4bf98ee956a8.js" defer=""></script><script src="/_next/static/-8k4Xu2rlgTZWfP5qtaGa/_buildManifest.js" defer=""></script><script src="/_next/static/-8k4Xu2rlgTZWfP5qtaGa/_ssgManifest.js" defer=""></script></head><body><div id="__next"><header class="Header_header__Z8PUO"><div class="Header_inner__tfr0u"><strong class="Header_title__Otn70"><a href="/">UIDEV CSS</a></strong><nav class="Header_nav_area__6KVpk"><a class="nav_item" href="/posts/1">Posts</a></nav></div></header><main class="posts_container__NyRU3"><div class="posts_inner__i3n_i"><h1 class="posts_post_title__EbxNx">플러터에서 ORM으로 Drift 사용하기</h1><div class="posts_meta__cR7lu"><div class="posts_profile_wrap__mslMl"><div class="posts_profile_image_wrap__kPikV"><img alt="플러터에서 ORM으로 Drift 사용하기" loading="lazy" width="44" height="44" decoding="async" data-nimg="1" class="profile" style="color:transparent" src="/favicons/apple-icon-114x114.png"/></div><div class="posts_textarea__w_iKT"><span class="writer">UIDEV CSS</span><span class="posts_info__5KJdN"><span class="posts_date__ctqHI">Posted On Jun 19, 2024</span><span class="posts_reading_time__f7YPP">6<!-- --> min read</span></span></div></div><img alt="" loading="lazy" width="50" height="50" decoding="async" data-nimg="1" class="posts_view_badge__tcbfm" style="color:transparent" src="https://hits.seeyoufarm.com/api/count/incr/badge.svg?url=https%3A%2F%2Fallround-coder.github.io/post/2024-06-19-UseDriftforORMinFlutter&amp;count_bg=%2379C83D&amp;title_bg=%23555555&amp;icon=&amp;icon_color=%23E7E7E7&amp;title=views&amp;edge_flat=false"/></div><article class="posts_post_content__n_L6j"><div><!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta content="width=device-width, initial-scale=1" name="viewport">
</head>
<body>
<h1>1. 소개</h1>
<p>Drift은 Dart와 Flutter 애플리케이션용 강력한 데이터베이스 라이브러리입니다. 타입 안정한 SQL 쿼리, 데이터베이스의 검증 및 마이그레이션과 같은 고급 기능을 지원하기 위해, 컴파일 시간에 실행되는 빌더와 명령줄 도구를 사용합니다.</p>
<p>아래 표를 마핑하기 위한 Dart 클래스를 생성할 수 있습니다:</p>
<pre><code class="hljs language-js"><span class="hljs-keyword">class</span> <span class="hljs-title class_">TodoItems</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">Table</span> {
  <span class="hljs-title class_">IntColumn</span> get id => <span class="hljs-title function_">integer</span>().<span class="hljs-title function_">autoIncrement</span>()();
  <span class="hljs-title class_">TextColumn</span> get title => <span class="hljs-title function_">text</span>().<span class="hljs-title function_">withLength</span>(<span class="hljs-attr">min</span>: <span class="hljs-number">6</span>, <span class="hljs-attr">max</span>: <span class="hljs-number">32</span>)();
  <span class="hljs-title class_">TextColumn</span> get content => <span class="hljs-title function_">text</span>().<span class="hljs-title function_">named</span>(<span class="hljs-string">'body'</span>)();
  <span class="hljs-title class_">IntColumn</span> get category => <span class="hljs-title function_">integer</span>().<span class="hljs-title function_">nullable</span>()();
}
</code></pre>
<p>하지만 저는 ORM 코딩을 생성하기 위해 SQL 문을 사용하는 것을 선호합니다 (나중에 보여드리겠습니다). 보통 테이블용 SQL을 먼저 생성하고, 그 SQL을 재사용해야 하기 때문에 괜찮을 거예요 🙂</p>
<h1>2. 사용법</h1>
<p>나중에 Drift에서 모델을 생성할 때 SQL 문을 사용하는 방법을 보여드리겠습니다.</p>
<h1>2.1 필수 라이브러리 가져오기</h1>
<p>Drift는 sqlite3와 코드를 생성하는 Flutter 빌드 러너를 기반으로 하고 있기 때문에, pubspec.yaml 파일에 아래 종속성을 가져와야합니다:</p>
<pre><code class="hljs language-yaml"><span class="hljs-attr">dependencies:</span>
  <span class="hljs-attr">drift:</span> <span class="hljs-string">^2.16.0</span>
  <span class="hljs-attr">sqlite3_flutter_libs:</span> <span class="hljs-string">^0.5.20</span>
  <span class="hljs-attr">path_provider:</span> <span class="hljs-string">^2.1.2</span>
  <span class="hljs-attr">path:</span> <span class="hljs-string">^1.9.0</span>

<span class="hljs-attr">dev_dependencies:</span>
  <span class="hljs-attr">drift_dev:</span> <span class="hljs-string">^2.16.0</span>
  <span class="hljs-attr">build_runner:</span> <span class="hljs-string">^2.4.8</span>
</code></pre>
<h1>2.2 데이터베이스 클래스 생성하기</h1>
<p>예를 들어, 책 데이터베이스를 생성해야 한다면 아래의 book_database.dart 파일을 만들 수 있습니다.</p>
<pre><code class="hljs language-dart"><span class="hljs-keyword">import</span> <span class="hljs-string">'dart:io'</span>;

<span class="hljs-keyword">import</span> <span class="hljs-string">'package:drift/drift.dart'</span>;
<span class="hljs-keyword">import</span> <span class="hljs-string">'package:path_provider/path_provider.dart'</span>;
<span class="hljs-keyword">import</span> <span class="hljs-string">'package:path/path.dart'</span> <span class="hljs-keyword">as</span> p;
<span class="hljs-keyword">import</span> <span class="hljs-string">'package:drift/native.dart'</span>;

<span class="hljs-keyword">part</span> <span class="hljs-string">'book_database.g.dart'</span>; <span class="hljs-comment">// 이 파일은 생성 파일이며 기존 db 파일과 동일한 파일 이름을 사용해야 함</span>

<span class="hljs-meta">@DriftDatabase</span>(
  include: {<span class="hljs-string">'book.drift'</span>}, <span class="hljs-comment">// 책 테이블을 만들기 위한 SQL 파일</span>
)
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">BookDatabase</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">_</span>$<span class="hljs-title">BookDatabase</span> </span>{
  BookDatabase() : <span class="hljs-keyword">super</span>(_openConnection());

  <span class="hljs-meta">@override</span>
  <span class="hljs-built_in">int</span> <span class="hljs-keyword">get</span> schemaVersion => <span class="hljs-number">1</span>;
}

LazyDatabase _openConnection() {
  <span class="hljs-keyword">return</span> LazyDatabase(() <span class="hljs-keyword">async</span> {
    <span class="hljs-comment">// 데이터베이스 파일인 db.sqlite을 여기 앱의 documents 폴더로 넣습니다.</span>
    <span class="hljs-keyword">final</span> dbFolder = <span class="hljs-keyword">await</span> getApplicationSupportDirectory();

    <span class="hljs-comment">// db 파일의 경로 설정</span>
    <span class="hljs-keyword">final</span> file = File(p.join(dbFolder.path, <span class="hljs-string">'book.db'</span>));
    <span class="hljs-keyword">return</span> NativeDatabase.createInBackground(file);
  });
}
</code></pre>
<h1>2.2 SQL 문장 파일 생성</h1>
<p>book.drift 파일을 생성하여 테이블을 만드는 일반적인 SQL 문장을 입력하고, SQL에서 사용자 정의 메서드도 생성할 수 있습니다.</p>
<pre><code class="hljs language-js"><span class="hljs-variable constant_">CREATE</span> <span class="hljs-variable constant_">TABLE</span> <span class="hljs-variable constant_">IF</span> <span class="hljs-variable constant_">NOT</span> <span class="hljs-variable constant_">EXISTS</span> <span class="hljs-string">"book"</span> (
            <span class="hljs-string">"id"</span> <span class="hljs-variable constant_">INTEGER</span> <span class="hljs-variable constant_">PRIMARY</span> <span class="hljs-variable constant_">KEY</span> <span class="hljs-variable constant_">NOT</span> <span class="hljs-variable constant_">NULL</span> <span class="hljs-variable constant_">UNIQUE</span>,
            <span class="hljs-string">"viewCount"</span> <span class="hljs-variable constant_">INTEGER</span> <span class="hljs-title function_">DEFAULT</span>(<span class="hljs-variable constant_">NULL</span>),
            <span class="hljs-string">"name"</span> <span class="hljs-title function_">VARCHAR</span>(<span class="hljs-number">64</span>) <span class="hljs-variable constant_">COLLATE</span> <span class="hljs-variable constant_">NOCASE</span> <span class="hljs-variable constant_">NOT</span> <span class="hljs-variable constant_">NULL</span> <span class="hljs-variable constant_">UNIQUE</span>,
            <span class="hljs-string">"artist"</span> <span class="hljs-title function_">VARCHAR</span>(<span class="hljs-number">64</span>) <span class="hljs-variable constant_">COLLATE</span> <span class="hljs-variable constant_">NOCASE</span> <span class="hljs-variable constant_">NOT</span> <span class="hljs-variable constant_">NULL</span>,
            <span class="hljs-string">"folder"</span> <span class="hljs-title function_">VARCHAR</span>(<span class="hljs-number">64</span>) <span class="hljs-variable constant_">COLLATE</span> <span class="hljs-variable constant_">NOCASE</span> <span class="hljs-variable constant_">NOT</span> <span class="hljs-variable constant_">NULL</span>,
            <span class="hljs-string">"coverImg"</span> <span class="hljs-title function_">VARCHAR</span>(<span class="hljs-number">64</span>) <span class="hljs-variable constant_">COLLATE</span> <span class="hljs-variable constant_">NOCASE</span> <span class="hljs-variable constant_">NOT</span> <span class="hljs-variable constant_">NULL</span>
);
<span class="hljs-variable constant_">CREATE</span> <span class="hljs-variable constant_">UNIQUE</span> <span class="hljs-variable constant_">INDEX</span> <span class="hljs-variable constant_">IF</span> <span class="hljs-variable constant_">NOT</span> <span class="hljs-variable constant_">EXISTS</span> <span class="hljs-string">"book_1"</span> <span class="hljs-variable constant_">ON</span> book (id);
<span class="hljs-variable constant_">CREATE</span> <span class="hljs-variable constant_">UNIQUE</span> <span class="hljs-variable constant_">INDEX</span> <span class="hljs-variable constant_">IF</span> <span class="hljs-variable constant_">NOT</span> <span class="hljs-variable constant_">EXISTS</span> <span class="hljs-string">"book_2"</span> <span class="hljs-variable constant_">ON</span> book (name);

<span class="hljs-attr">isBookExists</span>: <span class="hljs-title class_">Select</span> <span class="hljs-title function_">count</span>(*) <span class="hljs-keyword">from</span> book where name = :name <span class="hljs-title class_">Limit</span> <span class="hljs-number">1</span>;
<span class="hljs-attr">filterBooks</span>: <span class="hljs-variable constant_">SELECT</span> * <span class="hljs-variable constant_">FROM</span> book <span class="hljs-variable constant_">WHERE</span> $predicate;
<span class="hljs-attr">getTop10</span>: <span class="hljs-variable constant_">SELECT</span> * <span class="hljs-variable constant_">FROM</span> book <span class="hljs-variable constant_">ORDER</span> <span class="hljs-variable constant_">BY</span> viewCount <span class="hljs-variable constant_">DESC</span> <span class="hljs-title class_">Limit</span> <span class="hljs-number">10</span>;
</code></pre>
<p>여기서 간단한 book 테이블을 만들었고, id 및 name 열에 대한 인덱스를 생성했습니다. 한편, 3가지 사용자 정의 메서드도 만들었고, 이후에 사용 방법을 알려드리겠습니다.</p>
<p>코드를 생성한 후 drift가 dart 코드로 DB 도우미 클래스에서 이러한 3가지 메서드를 자동으로 생성할 것입니다.</p>
<h1>2.3 데이터베이스 도우미 클래스 생성하기</h1>
<p>아래 명령어를 실행하여 DB 헬퍼 클래스를 생성할 수 있습니다:</p>
<pre><code class="hljs language-js">dart run build_runner build
</code></pre>
<p>그 결과로 book_database.g.dart와 같은 하나의 파일이 더 생성될 것이고, 해당 파일 안에 사용자 정의 메서드도 찾을 수 있을 거예요. 물론, 이 동작 방식에 대해 걱정할 필요는 없습니다. 그냥 사용하면 됩니다!</p>
<h1>2.4 데이터베이스 헬퍼 사용하기</h1>
<p>우리는 예시로 GetX 프레임워크를 사용할 것입니다.</p>
<p>main.dart 파일에 BookDatabase 클래스를 넣어주세요.</p>
<pre><code class="hljs language-js"><span class="hljs-title class_">Get</span>.<span class="hljs-title function_">put</span>(<span class="hljs-title class_">BookDatabase</span>());
</code></pre>
<p>이제 우리는 어디서든 사용할 수 있습니다:</p>
<pre><code class="hljs language-js"><span class="hljs-comment">//책 DB 도우미 가져오기</span>
final <span class="hljs-title class_">BookDatabase</span> _bookDB = <span class="hljs-title class_">Get</span>.<span class="hljs-property">find</span>&#x3C;<span class="hljs-title class_">BookDatabase</span>>();

...

<span class="hljs-comment">//DB에서 모든 책 아이템 가져오기</span>
<span class="hljs-keyword">var</span> dbBooks = <span class="hljs-keyword">await</span> _bookDB.<span class="hljs-property">book</span>.<span class="hljs-title function_">select</span>().<span class="hljs-title function_">get</span>();
...
<span class="hljs-comment">//책 아이템의 folder 열만 업데이트하여 DB에 저장</span>
_bookDB.<span class="hljs-title function_">updateBookItem</span>(
  bookItem.<span class="hljs-property">id</span>,
  <span class="hljs-title class_">BookCompanion</span>(
      <span class="hljs-attr">folder</span>: drift.<span class="hljs-title class_">Value</span>(bookItem.<span class="hljs-property">folder</span>),
  ),
);
...
<span class="hljs-comment">//책 아이템 일괄 삽입</span>
<span class="hljs-title class_">List</span>&#x3C;<span class="hljs-title class_">BookData</span>> dbBooks = [];
dbBooks.<span class="hljs-title function_">add</span>(<span class="hljs-title class_">BookData</span>(
        <span class="hljs-attr">id</span>: <span class="hljs-number">1</span>,
        <span class="hljs-attr">viewCount</span>: <span class="hljs-number">0</span>,
        <span class="hljs-attr">name</span>: <span class="hljs-string">'book 1'</span>,
        <span class="hljs-attr">artist</span>: <span class="hljs-string">'artist 1'</span>,
        <span class="hljs-attr">folder</span>: <span class="hljs-string">'assets/books/01/'</span>,
        <span class="hljs-attr">coverImg</span>: <span class="hljs-string">'assets/books/01/cover.jpg'</span>,));
dbBooks.<span class="hljs-title function_">add</span>(<span class="hljs-title class_">BookData</span>(
        <span class="hljs-attr">id</span>: <span class="hljs-number">2</span>,
        <span class="hljs-attr">viewCount</span>: <span class="hljs-number">0</span>,
        <span class="hljs-attr">name</span>: <span class="hljs-string">'book 2'</span>,
        <span class="hljs-attr">artist</span>: <span class="hljs-string">'artist 2'</span>,
        <span class="hljs-attr">folder</span>: <span class="hljs-string">'assets/books/02/'</span>,
        <span class="hljs-attr">coverImg</span>: <span class="hljs-string">'assets/books/02/cover.jpg'</span>,));
_bookDB.<span class="hljs-property">book</span>.<span class="hljs-title function_">insertAll</span>(dbBooks);e custom methods
</code></pre>
<p>예제에서는 SQL 문으로 3개의 메서드를 정의했습니다:</p>
<pre><code class="hljs language-js"><span class="hljs-attr">isBookExists</span>: <span class="hljs-title class_">Select</span> <span class="hljs-title function_">count</span>(*) <span class="hljs-keyword">from</span> book where name = :name <span class="hljs-title class_">Limit</span> <span class="hljs-number">1</span> ;
<span class="hljs-attr">filterBooks</span>: <span class="hljs-variable constant_">SELECT</span> * <span class="hljs-variable constant_">FROM</span> book <span class="hljs-variable constant_">WHERE</span> $predicate;
<span class="hljs-attr">getTop10</span>: <span class="hljs-variable constant_">SELECT</span> * <span class="hljs-variable constant_">FROM</span> book <span class="hljs-variable constant_">ORDER</span> <span class="hljs-variable constant_">BY</span> viewCount <span class="hljs-variable constant_">DESC</span> <span class="hljs-title class_">Limit</span> <span class="hljs-number">10</span>;
</code></pre>
<p>아래에서 이를 사용할 수 있습니다.</p>
<pre><code class="hljs language-js"><span class="hljs-comment">// 도서 이름으로 책이 있는지 확인</span>
int bookCount = <span class="hljs-keyword">await</span> _bookDB.<span class="hljs-title function_">isBookExists</span>(<span class="hljs-string">'bookName'</span>).<span class="hljs-title function_">getSingle</span>();

<span class="hljs-comment">// 사용자 지정 필터로 책 가져오기</span>
<span class="hljs-keyword">var</span> bookItems = <span class="hljs-keyword">await</span> _bookDB.<span class="hljs-title function_">filterBooks</span>(<span class="hljs-function">(<span class="hljs-params">book</span>) =></span> book.<span class="hljs-property">name</span>.<span class="hljs-title function_">contains</span>(<span class="hljs-string">'bookName'</span>)).<span class="hljs-title function_">get</span>();

<span class="hljs-comment">// 상위 10권의 책 가져오기</span>
<span class="hljs-keyword">var</span> topTenBooks = <span class="hljs-keyword">await</span> _bookDB.<span class="hljs-title function_">getTop10</span>().<span class="hljs-title function_">get</span>();
</code></pre>
<h1>3. 결론</h1>
<p>Drift는 데이터베이스를 관리하는 데 유용합니다. 데이터를 가져오기 위해 사용자 지정 메서드를 생성할 수 있으며 SQL 문을 사용하지 않고 Dart API를 사용할 수도 있습니다. 자세한 내용은 여기에서 확인할 수 있습니다. 여전히 오피서 웹사이트에서 많은 강력한 기능을 찾을 수 있습니다.</p>
<p>이 글이 마음에 드셨다면 .Net Core, Angular 및 기타 기술에 관한 더 많은 이야기를 보려면 Medium에서 팔로우해주세요! 🙂</p>
</body>
</html>
</div></article></div></main></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"title":"플러터에서 ORM으로 Drift 사용하기","description":"","date":"2024-06-19 14:28","slug":"2024-06-19-UseDriftforORMinFlutter","content":"\n\n\u003cimg src=\"/assets/img/2024-06-19-UseDriftforORMinFlutter_0.png\" /\u003e\n\n# 1. 소개\n\nDrift은 Dart와 Flutter 애플리케이션용 강력한 데이터베이스 라이브러리입니다. 타입 안정한 SQL 쿼리, 데이터베이스의 검증 및 마이그레이션과 같은 고급 기능을 지원하기 위해, 컴파일 시간에 실행되는 빌더와 명령줄 도구를 사용합니다.\n\n아래 표를 마핑하기 위한 Dart 클래스를 생성할 수 있습니다:\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n```js\nclass TodoItems extends Table {\n  IntColumn get id =\u003e integer().autoIncrement()();\n  TextColumn get title =\u003e text().withLength(min: 6, max: 32)();\n  TextColumn get content =\u003e text().named('body')();\n  IntColumn get category =\u003e integer().nullable()();\n}\n```\n\n하지만 저는 ORM 코딩을 생성하기 위해 SQL 문을 사용하는 것을 선호합니다 (나중에 보여드리겠습니다). 보통 테이블용 SQL을 먼저 생성하고, 그 SQL을 재사용해야 하기 때문에 괜찮을 거예요 🙂\n\n# 2. 사용법\n\n나중에 Drift에서 모델을 생성할 때 SQL 문을 사용하는 방법을 보여드리겠습니다.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n# 2.1 필수 라이브러리 가져오기\n\nDrift는 sqlite3와 코드를 생성하는 Flutter 빌드 러너를 기반으로 하고 있기 때문에, pubspec.yaml 파일에 아래 종속성을 가져와야합니다:\n\n```yaml\ndependencies:\n  drift: ^2.16.0\n  sqlite3_flutter_libs: ^0.5.20\n  path_provider: ^2.1.2\n  path: ^1.9.0\n\ndev_dependencies:\n  drift_dev: ^2.16.0\n  build_runner: ^2.4.8\n```\n\n# 2.2 데이터베이스 클래스 생성하기\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n예를 들어, 책 데이터베이스를 생성해야 한다면 아래의 book_database.dart 파일을 만들 수 있습니다.\n\n```dart\nimport 'dart:io';\n\nimport 'package:drift/drift.dart';\nimport 'package:path_provider/path_provider.dart';\nimport 'package:path/path.dart' as p;\nimport 'package:drift/native.dart';\n\npart 'book_database.g.dart'; // 이 파일은 생성 파일이며 기존 db 파일과 동일한 파일 이름을 사용해야 함\n\n@DriftDatabase(\n  include: {'book.drift'}, // 책 테이블을 만들기 위한 SQL 파일\n)\nclass BookDatabase extends _$BookDatabase {\n  BookDatabase() : super(_openConnection());\n\n  @override\n  int get schemaVersion =\u003e 1;\n}\n\nLazyDatabase _openConnection() {\n  return LazyDatabase(() async {\n    // 데이터베이스 파일인 db.sqlite을 여기 앱의 documents 폴더로 넣습니다.\n    final dbFolder = await getApplicationSupportDirectory();\n\n    // db 파일의 경로 설정\n    final file = File(p.join(dbFolder.path, 'book.db'));\n    return NativeDatabase.createInBackground(file);\n  });\n}\n```\n\n# 2.2 SQL 문장 파일 생성\n\nbook.drift 파일을 생성하여 테이블을 만드는 일반적인 SQL 문장을 입력하고, SQL에서 사용자 정의 메서드도 생성할 수 있습니다.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n```js\nCREATE TABLE IF NOT EXISTS \"book\" (\n            \"id\" INTEGER PRIMARY KEY NOT NULL UNIQUE,\n            \"viewCount\" INTEGER DEFAULT(NULL),\n            \"name\" VARCHAR(64) COLLATE NOCASE NOT NULL UNIQUE,\n            \"artist\" VARCHAR(64) COLLATE NOCASE NOT NULL,\n            \"folder\" VARCHAR(64) COLLATE NOCASE NOT NULL,\n            \"coverImg\" VARCHAR(64) COLLATE NOCASE NOT NULL\n);\nCREATE UNIQUE INDEX IF NOT EXISTS \"book_1\" ON book (id);\nCREATE UNIQUE INDEX IF NOT EXISTS \"book_2\" ON book (name);\n\nisBookExists: Select count(*) from book where name = :name Limit 1;\nfilterBooks: SELECT * FROM book WHERE $predicate;\ngetTop10: SELECT * FROM book ORDER BY viewCount DESC Limit 10;\n```\n\n여기서 간단한 book 테이블을 만들었고, id 및 name 열에 대한 인덱스를 생성했습니다. 한편, 3가지 사용자 정의 메서드도 만들었고, 이후에 사용 방법을 알려드리겠습니다.\n\n코드를 생성한 후 drift가 dart 코드로 DB 도우미 클래스에서 이러한 3가지 메서드를 자동으로 생성할 것입니다.\n\n# 2.3 데이터베이스 도우미 클래스 생성하기\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n아래 명령어를 실행하여 DB 헬퍼 클래스를 생성할 수 있습니다:\n\n```js\ndart run build_runner build\n```\n\n그 결과로 book_database.g.dart와 같은 하나의 파일이 더 생성될 것이고, 해당 파일 안에 사용자 정의 메서드도 찾을 수 있을 거예요. 물론, 이 동작 방식에 대해 걱정할 필요는 없습니다. 그냥 사용하면 됩니다!\n\n# 2.4 데이터베이스 헬퍼 사용하기\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n우리는 예시로 GetX 프레임워크를 사용할 것입니다.\n\nmain.dart 파일에 BookDatabase 클래스를 넣어주세요.\n\n```js\nGet.put(BookDatabase());\n```\n\n이제 우리는 어디서든 사용할 수 있습니다:\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n```js\n//책 DB 도우미 가져오기\nfinal BookDatabase _bookDB = Get.find\u003cBookDatabase\u003e();\n\n...\n\n//DB에서 모든 책 아이템 가져오기\nvar dbBooks = await _bookDB.book.select().get();\n...\n//책 아이템의 folder 열만 업데이트하여 DB에 저장\n_bookDB.updateBookItem(\n  bookItem.id,\n  BookCompanion(\n      folder: drift.Value(bookItem.folder),\n  ),\n);\n...\n//책 아이템 일괄 삽입\nList\u003cBookData\u003e dbBooks = [];\ndbBooks.add(BookData(\n        id: 1,\n        viewCount: 0,\n        name: 'book 1',\n        artist: 'artist 1',\n        folder: 'assets/books/01/',\n        coverImg: 'assets/books/01/cover.jpg',));\ndbBooks.add(BookData(\n        id: 2,\n        viewCount: 0,\n        name: 'book 2',\n        artist: 'artist 2',\n        folder: 'assets/books/02/',\n        coverImg: 'assets/books/02/cover.jpg',));\n_bookDB.book.insertAll(dbBooks);e custom methods\n```\n\n예제에서는 SQL 문으로 3개의 메서드를 정의했습니다:\n\n```js\nisBookExists: Select count(*) from book where name = :name Limit 1 ;\nfilterBooks: SELECT * FROM book WHERE $predicate;\ngetTop10: SELECT * FROM book ORDER BY viewCount DESC Limit 10;\n```\n\n아래에서 이를 사용할 수 있습니다.\n\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n```js\n// 도서 이름으로 책이 있는지 확인\nint bookCount = await _bookDB.isBookExists('bookName').getSingle();\n\n// 사용자 지정 필터로 책 가져오기\nvar bookItems = await _bookDB.filterBooks((book) =\u003e book.name.contains('bookName')).get();\n\n// 상위 10권의 책 가져오기\nvar topTenBooks = await _bookDB.getTop10().get();\n```\n\n# 3. 결론\n\nDrift는 데이터베이스를 관리하는 데 유용합니다. 데이터를 가져오기 위해 사용자 지정 메서드를 생성할 수 있으며 SQL 문을 사용하지 않고 Dart API를 사용할 수도 있습니다. 자세한 내용은 여기에서 확인할 수 있습니다. 여전히 오피서 웹사이트에서 많은 강력한 기능을 찾을 수 있습니다.\n\n이 글이 마음에 드셨다면 .Net Core, Angular 및 기타 기술에 관한 더 많은 이야기를 보려면 Medium에서 팔로우해주세요! 🙂\n","ogImage":{"url":"/assets/img/2024-06-19-UseDriftforORMinFlutter_0.png"},"coverImage":"/assets/img/2024-06-19-UseDriftforORMinFlutter_0.png","tag":["Tech"],"readingTime":6},"content":"\u003c!doctype html\u003e\n\u003chtml lang=\"en\"\u003e\n\u003chead\u003e\n\u003cmeta charset=\"utf-8\"\u003e\n\u003cmeta content=\"width=device-width, initial-scale=1\" name=\"viewport\"\u003e\n\u003c/head\u003e\n\u003cbody\u003e\n\u003ch1\u003e1. 소개\u003c/h1\u003e\n\u003cp\u003eDrift은 Dart와 Flutter 애플리케이션용 강력한 데이터베이스 라이브러리입니다. 타입 안정한 SQL 쿼리, 데이터베이스의 검증 및 마이그레이션과 같은 고급 기능을 지원하기 위해, 컴파일 시간에 실행되는 빌더와 명령줄 도구를 사용합니다.\u003c/p\u003e\n\u003cp\u003e아래 표를 마핑하기 위한 Dart 클래스를 생성할 수 있습니다:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eTodoItems\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eextends\u003c/span\u003e \u003cspan class=\"hljs-title class_ inherited__\"\u003eTable\u003c/span\u003e {\n  \u003cspan class=\"hljs-title class_\"\u003eIntColumn\u003c/span\u003e get id =\u003e \u003cspan class=\"hljs-title function_\"\u003einteger\u003c/span\u003e().\u003cspan class=\"hljs-title function_\"\u003eautoIncrement\u003c/span\u003e()();\n  \u003cspan class=\"hljs-title class_\"\u003eTextColumn\u003c/span\u003e get title =\u003e \u003cspan class=\"hljs-title function_\"\u003etext\u003c/span\u003e().\u003cspan class=\"hljs-title function_\"\u003ewithLength\u003c/span\u003e(\u003cspan class=\"hljs-attr\"\u003emin\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e6\u003c/span\u003e, \u003cspan class=\"hljs-attr\"\u003emax\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e32\u003c/span\u003e)();\n  \u003cspan class=\"hljs-title class_\"\u003eTextColumn\u003c/span\u003e get content =\u003e \u003cspan class=\"hljs-title function_\"\u003etext\u003c/span\u003e().\u003cspan class=\"hljs-title function_\"\u003enamed\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'body'\u003c/span\u003e)();\n  \u003cspan class=\"hljs-title class_\"\u003eIntColumn\u003c/span\u003e get category =\u003e \u003cspan class=\"hljs-title function_\"\u003einteger\u003c/span\u003e().\u003cspan class=\"hljs-title function_\"\u003enullable\u003c/span\u003e()();\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e하지만 저는 ORM 코딩을 생성하기 위해 SQL 문을 사용하는 것을 선호합니다 (나중에 보여드리겠습니다). 보통 테이블용 SQL을 먼저 생성하고, 그 SQL을 재사용해야 하기 때문에 괜찮을 거예요 🙂\u003c/p\u003e\n\u003ch1\u003e2. 사용법\u003c/h1\u003e\n\u003cp\u003e나중에 Drift에서 모델을 생성할 때 SQL 문을 사용하는 방법을 보여드리겠습니다.\u003c/p\u003e\n\u003ch1\u003e2.1 필수 라이브러리 가져오기\u003c/h1\u003e\n\u003cp\u003eDrift는 sqlite3와 코드를 생성하는 Flutter 빌드 러너를 기반으로 하고 있기 때문에, pubspec.yaml 파일에 아래 종속성을 가져와야합니다:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-yaml\"\u003e\u003cspan class=\"hljs-attr\"\u003edependencies:\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003edrift:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e^2.16.0\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003esqlite3_flutter_libs:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e^0.5.20\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003epath_provider:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e^2.1.2\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003epath:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e^1.9.0\u003c/span\u003e\n\n\u003cspan class=\"hljs-attr\"\u003edev_dependencies:\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003edrift_dev:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e^2.16.0\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003ebuild_runner:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e^2.4.8\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch1\u003e2.2 데이터베이스 클래스 생성하기\u003c/h1\u003e\n\u003cp\u003e예를 들어, 책 데이터베이스를 생성해야 한다면 아래의 book_database.dart 파일을 만들 수 있습니다.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-dart\"\u003e\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'dart:io'\u003c/span\u003e;\n\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'package:drift/drift.dart'\u003c/span\u003e;\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'package:path_provider/path_provider.dart'\u003c/span\u003e;\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'package:path/path.dart'\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eas\u003c/span\u003e p;\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'package:drift/native.dart'\u003c/span\u003e;\n\n\u003cspan class=\"hljs-keyword\"\u003epart\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'book_database.g.dart'\u003c/span\u003e; \u003cspan class=\"hljs-comment\"\u003e// 이 파일은 생성 파일이며 기존 db 파일과 동일한 파일 이름을 사용해야 함\u003c/span\u003e\n\n\u003cspan class=\"hljs-meta\"\u003e@DriftDatabase\u003c/span\u003e(\n  include: {\u003cspan class=\"hljs-string\"\u003e'book.drift'\u003c/span\u003e}, \u003cspan class=\"hljs-comment\"\u003e// 책 테이블을 만들기 위한 SQL 파일\u003c/span\u003e\n)\n\u003cspan class=\"hljs-class\"\u003e\u003cspan class=\"hljs-keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"hljs-title\"\u003eBookDatabase\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eextends\u003c/span\u003e \u003cspan class=\"hljs-title\"\u003e_\u003c/span\u003e$\u003cspan class=\"hljs-title\"\u003eBookDatabase\u003c/span\u003e \u003c/span\u003e{\n  BookDatabase() : \u003cspan class=\"hljs-keyword\"\u003esuper\u003c/span\u003e(_openConnection());\n\n  \u003cspan class=\"hljs-meta\"\u003e@override\u003c/span\u003e\n  \u003cspan class=\"hljs-built_in\"\u003eint\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eget\u003c/span\u003e schemaVersion =\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e;\n}\n\nLazyDatabase _openConnection() {\n  \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e LazyDatabase(() \u003cspan class=\"hljs-keyword\"\u003easync\u003c/span\u003e {\n    \u003cspan class=\"hljs-comment\"\u003e// 데이터베이스 파일인 db.sqlite을 여기 앱의 documents 폴더로 넣습니다.\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword\"\u003efinal\u003c/span\u003e dbFolder = \u003cspan class=\"hljs-keyword\"\u003eawait\u003c/span\u003e getApplicationSupportDirectory();\n\n    \u003cspan class=\"hljs-comment\"\u003e// db 파일의 경로 설정\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword\"\u003efinal\u003c/span\u003e file = File(p.join(dbFolder.path, \u003cspan class=\"hljs-string\"\u003e'book.db'\u003c/span\u003e));\n    \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e NativeDatabase.createInBackground(file);\n  });\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch1\u003e2.2 SQL 문장 파일 생성\u003c/h1\u003e\n\u003cp\u003ebook.drift 파일을 생성하여 테이블을 만드는 일반적인 SQL 문장을 입력하고, SQL에서 사용자 정의 메서드도 생성할 수 있습니다.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-variable constant_\"\u003eCREATE\u003c/span\u003e \u003cspan class=\"hljs-variable constant_\"\u003eTABLE\u003c/span\u003e \u003cspan class=\"hljs-variable constant_\"\u003eIF\u003c/span\u003e \u003cspan class=\"hljs-variable constant_\"\u003eNOT\u003c/span\u003e \u003cspan class=\"hljs-variable constant_\"\u003eEXISTS\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"book\"\u003c/span\u003e (\n            \u003cspan class=\"hljs-string\"\u003e\"id\"\u003c/span\u003e \u003cspan class=\"hljs-variable constant_\"\u003eINTEGER\u003c/span\u003e \u003cspan class=\"hljs-variable constant_\"\u003ePRIMARY\u003c/span\u003e \u003cspan class=\"hljs-variable constant_\"\u003eKEY\u003c/span\u003e \u003cspan class=\"hljs-variable constant_\"\u003eNOT\u003c/span\u003e \u003cspan class=\"hljs-variable constant_\"\u003eNULL\u003c/span\u003e \u003cspan class=\"hljs-variable constant_\"\u003eUNIQUE\u003c/span\u003e,\n            \u003cspan class=\"hljs-string\"\u003e\"viewCount\"\u003c/span\u003e \u003cspan class=\"hljs-variable constant_\"\u003eINTEGER\u003c/span\u003e \u003cspan class=\"hljs-title function_\"\u003eDEFAULT\u003c/span\u003e(\u003cspan class=\"hljs-variable constant_\"\u003eNULL\u003c/span\u003e),\n            \u003cspan class=\"hljs-string\"\u003e\"name\"\u003c/span\u003e \u003cspan class=\"hljs-title function_\"\u003eVARCHAR\u003c/span\u003e(\u003cspan class=\"hljs-number\"\u003e64\u003c/span\u003e) \u003cspan class=\"hljs-variable constant_\"\u003eCOLLATE\u003c/span\u003e \u003cspan class=\"hljs-variable constant_\"\u003eNOCASE\u003c/span\u003e \u003cspan class=\"hljs-variable constant_\"\u003eNOT\u003c/span\u003e \u003cspan class=\"hljs-variable constant_\"\u003eNULL\u003c/span\u003e \u003cspan class=\"hljs-variable constant_\"\u003eUNIQUE\u003c/span\u003e,\n            \u003cspan class=\"hljs-string\"\u003e\"artist\"\u003c/span\u003e \u003cspan class=\"hljs-title function_\"\u003eVARCHAR\u003c/span\u003e(\u003cspan class=\"hljs-number\"\u003e64\u003c/span\u003e) \u003cspan class=\"hljs-variable constant_\"\u003eCOLLATE\u003c/span\u003e \u003cspan class=\"hljs-variable constant_\"\u003eNOCASE\u003c/span\u003e \u003cspan class=\"hljs-variable constant_\"\u003eNOT\u003c/span\u003e \u003cspan class=\"hljs-variable constant_\"\u003eNULL\u003c/span\u003e,\n            \u003cspan class=\"hljs-string\"\u003e\"folder\"\u003c/span\u003e \u003cspan class=\"hljs-title function_\"\u003eVARCHAR\u003c/span\u003e(\u003cspan class=\"hljs-number\"\u003e64\u003c/span\u003e) \u003cspan class=\"hljs-variable constant_\"\u003eCOLLATE\u003c/span\u003e \u003cspan class=\"hljs-variable constant_\"\u003eNOCASE\u003c/span\u003e \u003cspan class=\"hljs-variable constant_\"\u003eNOT\u003c/span\u003e \u003cspan class=\"hljs-variable constant_\"\u003eNULL\u003c/span\u003e,\n            \u003cspan class=\"hljs-string\"\u003e\"coverImg\"\u003c/span\u003e \u003cspan class=\"hljs-title function_\"\u003eVARCHAR\u003c/span\u003e(\u003cspan class=\"hljs-number\"\u003e64\u003c/span\u003e) \u003cspan class=\"hljs-variable constant_\"\u003eCOLLATE\u003c/span\u003e \u003cspan class=\"hljs-variable constant_\"\u003eNOCASE\u003c/span\u003e \u003cspan class=\"hljs-variable constant_\"\u003eNOT\u003c/span\u003e \u003cspan class=\"hljs-variable constant_\"\u003eNULL\u003c/span\u003e\n);\n\u003cspan class=\"hljs-variable constant_\"\u003eCREATE\u003c/span\u003e \u003cspan class=\"hljs-variable constant_\"\u003eUNIQUE\u003c/span\u003e \u003cspan class=\"hljs-variable constant_\"\u003eINDEX\u003c/span\u003e \u003cspan class=\"hljs-variable constant_\"\u003eIF\u003c/span\u003e \u003cspan class=\"hljs-variable constant_\"\u003eNOT\u003c/span\u003e \u003cspan class=\"hljs-variable constant_\"\u003eEXISTS\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"book_1\"\u003c/span\u003e \u003cspan class=\"hljs-variable constant_\"\u003eON\u003c/span\u003e book (id);\n\u003cspan class=\"hljs-variable constant_\"\u003eCREATE\u003c/span\u003e \u003cspan class=\"hljs-variable constant_\"\u003eUNIQUE\u003c/span\u003e \u003cspan class=\"hljs-variable constant_\"\u003eINDEX\u003c/span\u003e \u003cspan class=\"hljs-variable constant_\"\u003eIF\u003c/span\u003e \u003cspan class=\"hljs-variable constant_\"\u003eNOT\u003c/span\u003e \u003cspan class=\"hljs-variable constant_\"\u003eEXISTS\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"book_2\"\u003c/span\u003e \u003cspan class=\"hljs-variable constant_\"\u003eON\u003c/span\u003e book (name);\n\n\u003cspan class=\"hljs-attr\"\u003eisBookExists\u003c/span\u003e: \u003cspan class=\"hljs-title class_\"\u003eSelect\u003c/span\u003e \u003cspan class=\"hljs-title function_\"\u003ecount\u003c/span\u003e(*) \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e book where name = :name \u003cspan class=\"hljs-title class_\"\u003eLimit\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e;\n\u003cspan class=\"hljs-attr\"\u003efilterBooks\u003c/span\u003e: \u003cspan class=\"hljs-variable constant_\"\u003eSELECT\u003c/span\u003e * \u003cspan class=\"hljs-variable constant_\"\u003eFROM\u003c/span\u003e book \u003cspan class=\"hljs-variable constant_\"\u003eWHERE\u003c/span\u003e $predicate;\n\u003cspan class=\"hljs-attr\"\u003egetTop10\u003c/span\u003e: \u003cspan class=\"hljs-variable constant_\"\u003eSELECT\u003c/span\u003e * \u003cspan class=\"hljs-variable constant_\"\u003eFROM\u003c/span\u003e book \u003cspan class=\"hljs-variable constant_\"\u003eORDER\u003c/span\u003e \u003cspan class=\"hljs-variable constant_\"\u003eBY\u003c/span\u003e viewCount \u003cspan class=\"hljs-variable constant_\"\u003eDESC\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eLimit\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e10\u003c/span\u003e;\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e여기서 간단한 book 테이블을 만들었고, id 및 name 열에 대한 인덱스를 생성했습니다. 한편, 3가지 사용자 정의 메서드도 만들었고, 이후에 사용 방법을 알려드리겠습니다.\u003c/p\u003e\n\u003cp\u003e코드를 생성한 후 drift가 dart 코드로 DB 도우미 클래스에서 이러한 3가지 메서드를 자동으로 생성할 것입니다.\u003c/p\u003e\n\u003ch1\u003e2.3 데이터베이스 도우미 클래스 생성하기\u003c/h1\u003e\n\u003cp\u003e아래 명령어를 실행하여 DB 헬퍼 클래스를 생성할 수 있습니다:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003edart run build_runner build\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e그 결과로 book_database.g.dart와 같은 하나의 파일이 더 생성될 것이고, 해당 파일 안에 사용자 정의 메서드도 찾을 수 있을 거예요. 물론, 이 동작 방식에 대해 걱정할 필요는 없습니다. 그냥 사용하면 됩니다!\u003c/p\u003e\n\u003ch1\u003e2.4 데이터베이스 헬퍼 사용하기\u003c/h1\u003e\n\u003cp\u003e우리는 예시로 GetX 프레임워크를 사용할 것입니다.\u003c/p\u003e\n\u003cp\u003emain.dart 파일에 BookDatabase 클래스를 넣어주세요.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-title class_\"\u003eGet\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003eput\u003c/span\u003e(\u003cspan class=\"hljs-title class_\"\u003eBookDatabase\u003c/span\u003e());\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e이제 우리는 어디서든 사용할 수 있습니다:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-comment\"\u003e//책 DB 도우미 가져오기\u003c/span\u003e\nfinal \u003cspan class=\"hljs-title class_\"\u003eBookDatabase\u003c/span\u003e _bookDB = \u003cspan class=\"hljs-title class_\"\u003eGet\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003efind\u003c/span\u003e\u0026#x3C;\u003cspan class=\"hljs-title class_\"\u003eBookDatabase\u003c/span\u003e\u003e();\n\n...\n\n\u003cspan class=\"hljs-comment\"\u003e//DB에서 모든 책 아이템 가져오기\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e dbBooks = \u003cspan class=\"hljs-keyword\"\u003eawait\u003c/span\u003e _bookDB.\u003cspan class=\"hljs-property\"\u003ebook\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003eselect\u003c/span\u003e().\u003cspan class=\"hljs-title function_\"\u003eget\u003c/span\u003e();\n...\n\u003cspan class=\"hljs-comment\"\u003e//책 아이템의 folder 열만 업데이트하여 DB에 저장\u003c/span\u003e\n_bookDB.\u003cspan class=\"hljs-title function_\"\u003eupdateBookItem\u003c/span\u003e(\n  bookItem.\u003cspan class=\"hljs-property\"\u003eid\u003c/span\u003e,\n  \u003cspan class=\"hljs-title class_\"\u003eBookCompanion\u003c/span\u003e(\n      \u003cspan class=\"hljs-attr\"\u003efolder\u003c/span\u003e: drift.\u003cspan class=\"hljs-title class_\"\u003eValue\u003c/span\u003e(bookItem.\u003cspan class=\"hljs-property\"\u003efolder\u003c/span\u003e),\n  ),\n);\n...\n\u003cspan class=\"hljs-comment\"\u003e//책 아이템 일괄 삽입\u003c/span\u003e\n\u003cspan class=\"hljs-title class_\"\u003eList\u003c/span\u003e\u0026#x3C;\u003cspan class=\"hljs-title class_\"\u003eBookData\u003c/span\u003e\u003e dbBooks = [];\ndbBooks.\u003cspan class=\"hljs-title function_\"\u003eadd\u003c/span\u003e(\u003cspan class=\"hljs-title class_\"\u003eBookData\u003c/span\u003e(\n        \u003cspan class=\"hljs-attr\"\u003eid\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e,\n        \u003cspan class=\"hljs-attr\"\u003eviewCount\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e,\n        \u003cspan class=\"hljs-attr\"\u003ename\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'book 1'\u003c/span\u003e,\n        \u003cspan class=\"hljs-attr\"\u003eartist\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'artist 1'\u003c/span\u003e,\n        \u003cspan class=\"hljs-attr\"\u003efolder\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'assets/books/01/'\u003c/span\u003e,\n        \u003cspan class=\"hljs-attr\"\u003ecoverImg\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'assets/books/01/cover.jpg'\u003c/span\u003e,));\ndbBooks.\u003cspan class=\"hljs-title function_\"\u003eadd\u003c/span\u003e(\u003cspan class=\"hljs-title class_\"\u003eBookData\u003c/span\u003e(\n        \u003cspan class=\"hljs-attr\"\u003eid\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e,\n        \u003cspan class=\"hljs-attr\"\u003eviewCount\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e,\n        \u003cspan class=\"hljs-attr\"\u003ename\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'book 2'\u003c/span\u003e,\n        \u003cspan class=\"hljs-attr\"\u003eartist\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'artist 2'\u003c/span\u003e,\n        \u003cspan class=\"hljs-attr\"\u003efolder\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'assets/books/02/'\u003c/span\u003e,\n        \u003cspan class=\"hljs-attr\"\u003ecoverImg\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'assets/books/02/cover.jpg'\u003c/span\u003e,));\n_bookDB.\u003cspan class=\"hljs-property\"\u003ebook\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003einsertAll\u003c/span\u003e(dbBooks);e custom methods\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e예제에서는 SQL 문으로 3개의 메서드를 정의했습니다:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-attr\"\u003eisBookExists\u003c/span\u003e: \u003cspan class=\"hljs-title class_\"\u003eSelect\u003c/span\u003e \u003cspan class=\"hljs-title function_\"\u003ecount\u003c/span\u003e(*) \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e book where name = :name \u003cspan class=\"hljs-title class_\"\u003eLimit\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e ;\n\u003cspan class=\"hljs-attr\"\u003efilterBooks\u003c/span\u003e: \u003cspan class=\"hljs-variable constant_\"\u003eSELECT\u003c/span\u003e * \u003cspan class=\"hljs-variable constant_\"\u003eFROM\u003c/span\u003e book \u003cspan class=\"hljs-variable constant_\"\u003eWHERE\u003c/span\u003e $predicate;\n\u003cspan class=\"hljs-attr\"\u003egetTop10\u003c/span\u003e: \u003cspan class=\"hljs-variable constant_\"\u003eSELECT\u003c/span\u003e * \u003cspan class=\"hljs-variable constant_\"\u003eFROM\u003c/span\u003e book \u003cspan class=\"hljs-variable constant_\"\u003eORDER\u003c/span\u003e \u003cspan class=\"hljs-variable constant_\"\u003eBY\u003c/span\u003e viewCount \u003cspan class=\"hljs-variable constant_\"\u003eDESC\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eLimit\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e10\u003c/span\u003e;\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e아래에서 이를 사용할 수 있습니다.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-comment\"\u003e// 도서 이름으로 책이 있는지 확인\u003c/span\u003e\nint bookCount = \u003cspan class=\"hljs-keyword\"\u003eawait\u003c/span\u003e _bookDB.\u003cspan class=\"hljs-title function_\"\u003eisBookExists\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'bookName'\u003c/span\u003e).\u003cspan class=\"hljs-title function_\"\u003egetSingle\u003c/span\u003e();\n\n\u003cspan class=\"hljs-comment\"\u003e// 사용자 지정 필터로 책 가져오기\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e bookItems = \u003cspan class=\"hljs-keyword\"\u003eawait\u003c/span\u003e _bookDB.\u003cspan class=\"hljs-title function_\"\u003efilterBooks\u003c/span\u003e(\u003cspan class=\"hljs-function\"\u003e(\u003cspan class=\"hljs-params\"\u003ebook\u003c/span\u003e) =\u003e\u003c/span\u003e book.\u003cspan class=\"hljs-property\"\u003ename\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003econtains\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'bookName'\u003c/span\u003e)).\u003cspan class=\"hljs-title function_\"\u003eget\u003c/span\u003e();\n\n\u003cspan class=\"hljs-comment\"\u003e// 상위 10권의 책 가져오기\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e topTenBooks = \u003cspan class=\"hljs-keyword\"\u003eawait\u003c/span\u003e _bookDB.\u003cspan class=\"hljs-title function_\"\u003egetTop10\u003c/span\u003e().\u003cspan class=\"hljs-title function_\"\u003eget\u003c/span\u003e();\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch1\u003e3. 결론\u003c/h1\u003e\n\u003cp\u003eDrift는 데이터베이스를 관리하는 데 유용합니다. 데이터를 가져오기 위해 사용자 지정 메서드를 생성할 수 있으며 SQL 문을 사용하지 않고 Dart API를 사용할 수도 있습니다. 자세한 내용은 여기에서 확인할 수 있습니다. 여전히 오피서 웹사이트에서 많은 강력한 기능을 찾을 수 있습니다.\u003c/p\u003e\n\u003cp\u003e이 글이 마음에 드셨다면 .Net Core, Angular 및 기타 기술에 관한 더 많은 이야기를 보려면 Medium에서 팔로우해주세요! 🙂\u003c/p\u003e\n\u003c/body\u003e\n\u003c/html\u003e\n"},"__N_SSG":true},"page":"/post/[slug]","query":{"slug":"2024-06-19-UseDriftforORMinFlutter"},"buildId":"-8k4Xu2rlgTZWfP5qtaGa","isFallback":false,"gsp":true,"scriptLoader":[{"async":true,"src":"https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4877378276818686","strategy":"lazyOnload","crossOrigin":"anonymous"}]}</script></body></html>